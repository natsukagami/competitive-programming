<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META content="no-cache" http-equiv="pragma">
    <META content="-1" http-equiv="expires">
    <META content="text/html;charset=UTF-8" http-equiv="content-type">
    <LINK href="problem-statement.css" rel="stylesheet" type="text/css">
    <TITLE>Hard route</TITLE>
</HEAD><BODY>
    <DIV class="problem-statement"><DIV class="header"><DIV class="title">Hard route</DIV><DIV class="time-limit"><DIV class="property-title">time limit per test</DIV>1 second</DIV><DIV class="memory-limit"><DIV class="property-title">memory limit per test</DIV>256 megabytes</DIV><DIV class="input-file"><DIV class="property-title">input</DIV>road.in</DIV><DIV class="output-file"><DIV class="property-title">output</DIV>road.out</DIV></DIV><DIV class="legend"><P>Mansur &nbsp;&mdash; is governor of the country ACMstan. There are <SPAN class="tex-span"><I>N</I></SPAN> cities and <SPAN class="tex-span"><I>N</I>&thinsp;-&thinsp;1</SPAN> two-way roads in this country. It is known that from any city you can go to any other city moving along existing roads. More formally, the country looks like a tree, where the vertices are cities and the edges are two-way roads.</P><P>Also, in this country, the cities with <SPAN class="tex-font-style-bf">exactly one</SPAN> connected road called <SPAN class="tex-font-style-it">terminal</SPAN>. A route is a simple path from one <SPAN class="tex-font-style-it">terminal</SPAN> to another <SPAN class="tex-font-style-it">terminal</SPAN>. The distance between two cities is the minimum number of roads on the way between them. The distance from city to the route is the minimum number of roads on the way from given city to any city on the route. Mansur decided to implement <SPAN class="tex-font-style-bf">exactly one</SPAN> route in ACMstan, however he interested in only <SPAN class="tex-font-style-it">hard</SPAN> routes. Hardness of route computed as follows: let <SPAN class="tex-span"><I>A</I></SPAN> and <SPAN class="tex-span"><I>B</I></SPAN> are <SPAN class="tex-font-style-it">terminals</SPAN> of the route, and <SPAN class="tex-span"><I>H</I></SPAN> is the maximum distance from any city in the country to this route, then the <SPAN class="tex-font-style-it">hardness</SPAN> of route is product of <SPAN class="tex-span"><I>H</I></SPAN> and the distance between <SPAN class="tex-span"><I>A</I></SPAN> and <SPAN class="tex-span"><I>B</I></SPAN>.</P><P>Mansur asked Temirulan to find maximal <SPAN class="tex-font-style-it">hardness</SPAN> over all routes, in fact he is interested to know the number of such routes. Temirulan asking help from you.</P><P>It's strongly recommend to read explanation below.</P></DIV><P></P><P></P><DIV class="input-specification"><DIV class="section-title">Input</DIV><P></P><P>First line of input contains a positive integer <SPAN class="tex-span"><I>N</I></SPAN> (<SPAN class="tex-span">2&thinsp;&le;&thinsp;<I>N</I>&thinsp;&le;&thinsp;500000</SPAN>)&nbsp;&mdash; the number of cities in the country. The cities are numbered from <SPAN class="tex-span">1</SPAN> to <SPAN class="tex-span"><I>N</I></SPAN>. The following <SPAN class="tex-span"><I>N</I>&thinsp;-&thinsp;1</SPAN> lines contain <SPAN class="tex-span">2</SPAN> positive integers, separated by single space, <SPAN class="tex-span"><I>u</I><SUB class="lower-index"><I>i</I></SUB></SPAN>, <SPAN class="tex-span"><I>v</I><SUB class="lower-index"><I>i</I></SUB></SPAN> (<SPAN class="tex-span">1&thinsp;&le;&thinsp;<I>u</I><SUB class="lower-index"><I>i</I></SUB>,&thinsp;<I>v</I><SUB class="lower-index"><I>i</I></SUB>&thinsp;&le;&thinsp;<I>N</I>;<I>u</I><SUB class="lower-index"><I>i</I></SUB>&thinsp;&ne;&thinsp;<I>v</I><SUB class="lower-index"><I>i</I></SUB></SPAN>)&nbsp;&mdash; road connecting cities <SPAN class="tex-span"><I>u</I><SUB class="lower-index"><I>i</I></SUB></SPAN> and <SPAN class="tex-span"><I>v</I><SUB class="lower-index"><I>i</I></SUB></SPAN>. It is guaranteed that the given graph is a tree.</P></DIV><P></P><P></P><DIV class="output-specification"><DIV class="section-title">Output</DIV><P></P><P>Output in single line two integers &nbsp;&mdash; the maximal <SPAN class="tex-font-style-it">hardness</SPAN> and the number of routes, separated by single spaces. <SPAN class="tex-font-style-bf">Note that</SPAN>, route from <SPAN class="tex-span"><I>A</I></SPAN> to <SPAN class="tex-span"><I>B</I></SPAN> and route from <SPAN class="tex-span"><I>B</I></SPAN> to <SPAN class="tex-span"><I>A</I></SPAN> are <SPAN class="tex-font-style-bf">the same</SPAN> routes.</P></DIV><P></P><P></P><DIV class="scoring"><DIV class="section-title">Scoring</DIV><P></P><P>This problem consists of three subtasks: </P><OL type="1"> <LI> <SPAN class="tex-span">2&thinsp;&le;&thinsp;<I>N</I>&thinsp;&le;&thinsp;100</SPAN>. Score <SPAN class="tex-span">19</SPAN> points. </LI><LI> <SPAN class="tex-span">2&thinsp;&le;&thinsp;<I>N</I>&thinsp;&le;&thinsp;5000</SPAN>. Score <SPAN class="tex-span">33</SPAN> points. </LI><LI> <SPAN class="tex-span">2&thinsp;&le;&thinsp;<I>N</I>&thinsp;&le;&thinsp;500000</SPAN>. Score <SPAN class="tex-span">48</SPAN> points. </LI></OL><P></P><P>Each subtask will be scored if only if the solution successfully passes all of the previous subtasks.</P></DIV><P></P><P></P><DIV class="sample-tests"><DIV class="section-title">Examples</DIV><P></P><P></P><DIV class="sample-test"><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">7<BR>1 2<BR>1 3<BR>2 4<BR>2 5<BR>3 6<BR>3 7<BR></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">6 2<BR></PRE></DIV><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">4<BR>1 2<BR>2 3<BR>2 4<BR></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">2 3<BR></PRE></DIV><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">5<BR>1 2<BR>2 3<BR>3 4<BR>4 5<BR></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">0 1<BR></PRE></DIV></DIV></DIV><P></P><P></P><DIV class="note"><DIV class="section-title">Note</DIV><P></P><P>A simple path is a path with no repeated vertices. <SPAN class="tex-font-style-bf">Note</SPAN>, that there may be simple path which is not route.</P><P>First sample test:</P><P>There is four <SPAN class="tex-font-style-it">terminal</SPAN> cities with number 4, 5, 6 and 7. For route 4-2-1-3-6, the distance is 4 and distances from other cities to this route is [1, 1], maximum among them is 1, so the <SPAN class="tex-font-style-it">hardness</SPAN> of route is equal to <SPAN class="tex-span">4&thinsp;&times;&thinsp;1&thinsp;=&thinsp;4</SPAN>. For route 4-2-5, the distance is 2, maximum distance among other cities is 3 (from 6 or 7), <SPAN class="tex-font-style-it">hardness</SPAN> of route equal to <SPAN class="tex-span">3&thinsp;&times;&thinsp;2&thinsp;=&thinsp;6</SPAN>. <SPAN class="tex-font-style-it">Hardness</SPAN> of 6-3-7 also 6, but other routes has smaller <SPAN class="tex-font-style-it">hardness</SPAN>.</P><P>In third sample test there is only two <SPAN class="tex-font-style-it">terminal</SPAN> cities 1 and 5, so there is exactly one route 1-2-3-4-5, the distance is 4 and maximum distance among all cities to route is 0, because all cities are on this route already. <SPAN class="tex-font-style-it">Hardness</SPAN> is equal to <SPAN class="tex-span">4&thinsp;&times;&thinsp;0&thinsp;=&thinsp;0</SPAN>.</P></DIV></DIV><P></P><P>  

</P></BODY></HTML>